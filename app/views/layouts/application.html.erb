<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
       "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <meta http-equiv="content-type" content="text/html;charset=UTF-8" />
  <title>Stats: <%= controller.action_name %></title>
  <%= stylesheet_link_tag 'scaffold' %>
  <%= javascript_include_tag :defaults %>
  <script>
  	var numericExpression = /^[0-9]+$/;
  	function check_vals(el, max)
	{
		if (el.value == null || el.value == "")
			el.value = 0; 
		if (!(el.value.match(numericExpression)))
			el.value = 0;
		if (el.value < 0 || el.value > max )
		{
			el.value = 0;
			alert("Improper value in " + el.name.match(/\[.*\]/)[0]);
			el.focus();
		}
	}
	
	function check_times()
	{
		var els = stat_list.getElementsByClassName("time_col");
		for (var i = 0; i < els.length; i++){
			if (els[i].innerHTML == stat_time.value) {
				alert("This time has already been recorded!");
				stat_time.value = stat_time.children[stat_time.selectedIndex + 1];
				stat_time.focus();
			}
		}
		
	}
	
	function update_total()
	{
		check_vals(stat_scanners, 2);
		check_vals(stat_video, 8);
		check_vals(stat_macs, 30);
		check_vals(stat_sa_short, 30);
		check_vals(stat_sa_long, 50);
		check_vals(stat_gu, 70);
		check_vals(stat_ll, 10);
		check_vals(stat_ref, 38);
		
		
		stat_total.value = parseInt(stat_scanners.value) + parseInt(stat_video.value) +
			parseInt(stat_macs.value) + parseInt(stat_sa_short.value) + parseInt(stat_sa_long.value) + 
			parseInt(stat_gu.value) + parseInt(stat_ll.value) + parseInt(stat_ref.value); 
	}
</script>
</head>
<body>

<p style="color: green" id="notice"><%= flash[:notice] %></p>
<p style="float:right;">Logged in as: <%= current_user %></p>
<%= yield %>

	<% if (ENV["RAILS_ENV"] == "development") || admin? -%>
      <div id="debug">

        <a href="#" onclick="Element.toggle('params_debug_info');return false;">
            params
          </a> |
        <a href="#" onclick="Element.toggle('session_debug_info');return false;">
          session
        </a> |
        <a href="#" onclick="Element.toggle('env_debug_info');return false;">
          env
        </a> |
        <a href="#" onclick="Element.toggle('request_debug_info');return false;">
          request
        </a> |
        <fieldset id="params_debug_info" class="debug_info">
          <legend>params</legend>
          <%= debug(params) %>
        </fieldset>
        <fieldset id="session_debug_info" class="debug_info" style="display: none;">
          <legend>session</legend>
          <%= debug(session) %>
        </fieldset>
        <fieldset id="env_debug_info" class="debug_info" style="display: none;">
          <legend>env</legend>
          <%= debug(request.env) %>
        </fieldset>
        <fieldset id="request_debug_info" class="debug_info" style="display: none;">
          <legend>request</legend>
          <%= debug(request) %>
        </fieldset>
      </div>
    <% end -%>
</body>
</html>
